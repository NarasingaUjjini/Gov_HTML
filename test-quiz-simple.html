<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Quiz Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .question { background: #f5f5f5; padding: 20px; margin: 20px 0; border-radius: 5px; }
        .option { display: block; margin: 10px 0; padding: 10px; background: white; border: 1px solid #ddd; cursor: pointer; }
        .option:hover { background: #e9ecef; }
        .option.selected { background: #007bff; color: white; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>Simple Quiz Test</h1>
    <button id="start-btn">Start Quiz</button>
    
    <div id="quiz-container" style="display: none;">
        <div id="question-display"></div>
        <div id="controls">
            <button id="submit-btn" disabled>Submit Answer</button>
            <button id="next-btn">Next Question</button>
        </div>
    </div>

    <script>
        let questions = [];
        let currentQuestionIndex = 0;
        let selectedAnswer = null;

        // Load questions
        async function loadQuestions() {
            try {
                console.log('Loading questions...');
                const response = await fetch('ap_gov_complete_question_bank.json');
                const data = await response.json();
                questions = data.questions || data;
                console.log(`Loaded ${questions.length} questions`);
                return true;
            } catch (error) {
                console.error('Failed to load questions:', error);
                // Use sample questions
                questions = this.createSampleQuestions();
                console.log(`Using ${questions.length} sample questions`);
                return true;
            }
            
            // Check if loaded questions have valid correct answers
            const validQuestions = questions.filter(q => 
                q.correct !== null && 
                q.correct !== undefined && 
                q.options && 
                q.options.length > 0
            );
            
            if (validQuestions.length === 0) {
                console.warn('No valid questions found in question bank, using sample questions');
                questions = this.createSampleQuestions();
            } else if (validQuestions.length < questions.length) {
                console.warn(`Only ${validQuestions.length} out of ${questions.length} questions have valid answers`);
                questions = validQuestions;
            }
        }
        
        createSampleQuestions() {
            return [
                {
                    question: "Which amendment guarantees freedom of speech?",
                    options: ["First Amendment", "Second Amendment", "Fourth Amendment", "Fifth Amendment"],
                    correct: 0,
                    explanation: "The First Amendment protects freedom of speech, religion, press, assembly, and petition."
                },
                {
                    question: "How many branches of government are there in the United States?",
                    options: ["Two", "Three", "Four", "Five"],
                    correct: 1,
                    explanation: "The three branches are Legislative (Congress), Executive (President), and Judicial (Courts)."
                },
                {
                    question: "What is the system called that prevents any one branch of government from becoming too powerful?",
                    options: ["Federalism", "Checks and balances", "Separation of powers", "Popular sovereignty"],
                    correct: 1,
                    explanation: "Checks and balances allows each branch to limit the power of the other branches."
                },
                {
                    question: "How many senators does each state have?",
                    options: ["One", "Two", "Three", "It depends on population"],
                    correct: 1,
                    explanation: "Each state has exactly two senators, regardless of population size."
                },
                {
                    question: "What is the minimum age requirement to be President?",
                    options: ["30 years old", "35 years old", "40 years old", "45 years old"],
                    correct: 1,
                    explanation: "The Constitution requires the President to be at least 35 years old."
                }
            ];
        }
        }

        function displayQuestion() {
            if (currentQuestionIndex >= questions.length) {
                alert('Quiz complete!');
                return;
            }

            const question = questions[currentQuestionIndex];
            const container = document.getElementById('question-display');
            
            container.innerHTML = `
                <div class="question">
                    <h3>Question ${currentQuestionIndex + 1}: ${question.question}</h3>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" data-index="${index}">${option}</div>
                        `).join('')}
                    </div>
                </div>
            `;

            // Add click handlers
            container.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', () => {
                    // Clear previous selection
                    container.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    // Select this option
                    option.classList.add('selected');
                    selectedAnswer = parseInt(option.dataset.index);
                    document.getElementById('submit-btn').disabled = false;
                });
            });

            selectedAnswer = null;
            document.getElementById('submit-btn').disabled = true;
        }

        function submitAnswer() {
            if (selectedAnswer === null) return;
            
            const question = questions[currentQuestionIndex];
            const isCorrect = selectedAnswer === question.correct;
            
            let message = isCorrect ? '✓ Correct!' : '✗ Incorrect';
            if (!isCorrect && question.correct !== null && question.options[question.correct]) {
                message += `\n\nThe correct answer was: ${question.options[question.correct]}`;
            }
            if (question.explanation) {
                message += `\n\n${question.explanation}`;
            }
            
            alert(message);
            
            currentQuestionIndex++;
            displayQuestion();
        }

        // Event listeners
        document.getElementById('start-btn').addEventListener('click', async () => {
            console.log('Start button clicked');
            await loadQuestions();
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            displayQuestion();
        });

        document.getElementById('submit-btn').addEventListener('click', submitAnswer);
        
        document.getElementById('next-btn').addEventListener('click', () => {
            currentQuestionIndex++;
            displayQuestion();
        });
    </script>
</body>
</html>